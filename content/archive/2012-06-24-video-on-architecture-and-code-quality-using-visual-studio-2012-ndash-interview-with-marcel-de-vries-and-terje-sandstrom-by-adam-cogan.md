---
id: 150035
title: 'Video on Architecture and Code Quality using Visual Studio 2012&ndash;interview with Marcel de Vries and Terje Sandstrom by Adam Cogan'
date: 2012-06-24T19:40:48+01:00
author: terje
layout: post
guid: http://terje.wpengine.com/?p=150035
permalink: /video-on-architecture-and-code-quality-using-visual-studio-2012-ndash-interview-with-marcel-de-vries-and-terje-sandstrom-by-adam-cogan/
dsq_thread_id:
  - "5109769720"
categories:
  - Code Analysis
  - Visual Studio
---
<p>Find the video <a href="http://tv.ssw.com/1709/important-tips-for-improving-your-architecture-and-code-reviews-with-marcel-de-vries-and-terje-sandstrom" target="_blank"><u>HERE</u></a><strong></strong>.</p>  <p><font color="#ff0000">Updated June 28th 2012:</font>  Marcel has <a href="http://blogs.infosupport.com/how-to-improve-your-code-reviews/" target="_blank"><u>blogged</u></a> about this too.</p>  <p> </p>  <p><a href="http://www.adamcogan.com/" target="_blank"><u>Adam Cogan</u></a> did a great <a href="http://tv.ssw.com/1709/important-tips-for-improving-your-architecture-and-code-reviews-with-marcel-de-vries-and-terje-sandstrom" target="_blank"><u>Web TV interview</u></a> with <a href="http://blogs.infosupport.com/author/marcelv/" target="_blank"><u>Marcel de Vries</u></a> and myself on the topics of architecture and code quality.  It was real fun participating in this session.  Although we know each other from the MVP ALM community,  Marcel, Adam and I haven’t worked together before. It was very interesting to see how we agreed on so many terms, and how alike we where thinking.  The basics of ensuring you have a good architecture and how you could document it is one thing.  Also, the same agreement on the importance of having a high quality code base, and how we used the <a href="http://www.microsoft.com/visualstudio/11/en-us/downloads" target="_blank"><u>Visual Studio 2012</u></a> tools, and some others (<a href="http://www.ndepend.com/" target="_blank"><u>NDepend</u></a> for example)  to measure and ensure that the code quality was where it should be.  As the tools, methods and thinking popped up during the interview it was a lot of “Hey !  I do that too!”.  </p>  <p>The tools are not only for “after the fact” work, but we use them during the coding.  That way the tools becomes an integrated part of our coding work, and helps us to find issues we may have overlooked.  </p>  <p>The video has a bunch of call outs, pinpointing important things to remember. These are also listed on the corresponding web page. I haven’t seen that touch before, but really liked this way of doing it – it makes it much easier to spot the highlights.  </p>  <p>Titus Maclaren and Raj Dhatt from <a href="http://www.ssw.com.au/" target="_blank"><u>SSW</u></a> have done a terrific job producing this video.  And thanks to Lei Xu for doing the camera and recording job.  Thanks guys !</p>  <p>Also, if you are at TechEd Amsterdam 2012, go and listen to Adam Cogan in his session on “<a href="http://europe.msteched.com/Sessions/Track/Developer-Tools-Languages-and-Frameworks" target="_blank"><u>A modern architecture review: Using the new code review tools</u></a>” Friday 29th, 10.15-11.30 and Marcel de Vries session on “<a href="http://europe.msteched.com/Sessions/Track/Developer-Tools-Languages-and-Frameworks?page=2" target="_blank"><u>Intellitrace, what is it and how can I use it to my benefit</u></a>” Wednesday 27th, 5-6.15</p>  <p>The highlights points out some important practices.  I’ll elaborate on a few of them here:</p>  <ul>   <li>Add instructions on how to compile the solution.  You do this by adding a text file with instructions to the solution, and keep it under source control.  These instructions should contain what is needed on top of a standard install of Visual Studio.  I do a lot of code reviews, and more often that not, I am not even able to compile the program, because they have used some tool or library that needs to be installed.  The same applies to any new developer who enters into the team, so do this to increase your productivity when the team changes, or a team member switches computer.      <ul>       <li>Don’t forget to document what you have to configure on the computer, the IIS being a common one. </li>        <li>The more automatic you can do this, the better.  Use <a href="http://visualstudiogallery.msdn.microsoft.com/27077b70-9dad-4c64-adcf-c7cf6bc9970c" target="_blank"><u>NuGet</u></a> to get down libraries. </li>        <li>When the text document gets more than say, half a page, with a bunch of different things to do, convert it into a powershell script instead.  </li>     </ul>   </li>    <li>The metrics warning levels.  These are very conservatively set by Microsoft.  You rarely see anything but green, and besides, you should have color scales for each of the metrics.  I have a <a href="http://geekswithblogs.net/terje/archive/2008/11/25/code-metrics---suggestions-for-appropriate-limits.aspx" target="_blank"><u>blog post</u></a> describing a more appropriate set of levels, based on both research work and industry “best practices”.  The essential limits are:       <ul>       <li>Cyclomatic complexity and coupling:  Higher numbers are worse          <ul>           <li>On method levels:              <ul>               <li>Green :  From 0 to 10 </li>                <li>Yellow:  From 10 to 20  (some say 15).   Acceptable, but have a look to see if there is something unneeded here. </li>                <li>Red: From 20 to 40:   Action required, get these down. </li>                <li>Bleeding Red: Above 40   This is the real red alert.  Immediate action!  (My invention, as people have asked what do I do when I have cyclomatic complexity of 150.  The only answer I could think of was: RUN! ) </li>             </ul>           </li>         </ul>       </li>        <li>Maintainability index:  Lower numbers are worse, scale from 0 to 100.          <ul>           <li>On method levels:              <ul>               <li>Green:  60 to 100 </li>                <li>Yellow:  40 – 60.    You will always have methods here too, accept the higher ones, take a look at those who are down to the lower limit.  Check up against the other metrics.) </li>                <li>Red:  20 – 40:  Action required, fix these. </li>                <li>Bleeding red:  Below 20.  Immediate action required. </li>             </ul>           </li>         </ul>       </li>        <li>When doing metrics analysis, you should leave the generated code out.  You do this by adding attributes, unfortunately Microsoft has “forgotten” to add these to all their stuff, so you might have to add them to some of the code.  It most cases it can be done so that it is not overwritten by a new round of code generation.  Take a look a my <a href="http://geekswithblogs.net/terje/archive/2008/11/10/hiding-generated-code-from-code-analysis-metrics-and-test-coverage.aspx" target="_blank"><u>blog post here</u></a> for details on how to do that. </li>        <li>Class level metrics might also be useful, at least for coupling and maintenance.  But it is much more difficult to set any fixed limits on those.  Any metric aggregations on higher level tend to be pretty useless, as the number of methods vary pretty much, and there are little science on what number of methods can be regarded as good or bad.  NDepend have a <a href="http://www.ndepend.com/Metrics.aspx#NbMethods" target="_blank"><u>recommendation</u></a>, but they say it may vary too.  And in these days of data binding, the number might be pretty high, as properties counts as methods.  However, if you take the worst case situations, classes with more than 20 methods are suspicious, and coupling and cyclomatic complexity go red above 20, so any classes with more than 20x20 = 400 for these measures should be checked over. </li>     </ul>   </li>    <li>In the video we mention <a href="http://www.butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod" target="_blank"><u>the SOLID principles</u></a><u>,</u> coined by “Uncle Bob” (Richard Martin). One of them, the Dependency Inversion principle we discuss in the video.  It is important to note that this principle is NOT on whether you should use a Dependency Inversion Container or not, it is about how you design the interfaces and interactions between your classes.  The Dependency Inversion Container is just one technique which is based on this principle, but which main purpose is to isolate things you would like to change at runtime, for example if you implement a plug in architecture.  Overuse of a Dependency Inversion Container is however, NOT a good thing.  It should be used for a purpose and not as a general DI solution.  The general DI solution and thinking however is useful far beyond the DIC.   You should always “program to an abstraction”, and not to the concreteness.  </li>    <li>We also talk a bit about the GRASP patterns, a term coined by Craig Larman in his book <a href="http://www.objectsbydesign.com/books/applying_uml.html" target="_blank"><u>Applying UML and design patterns</u></a>. GRASP patterns stand for General Responsibility Assignment Software Patterns and describe fundamental principles of object design and responsibility assignment.  What I find great with these patterns is that they is another way to focus on the responsibility of a class.  One of the things I most often found that is broken in software designs, is that the class lack responsibility, and as a result there are a lot of classes mucking around in the internals of the other classes.  </li>    <li>We also discuss the term “<a href="http://martinfowler.com/bliki/CodeSmell.html" target="_blank"><u>Code Smells</u></a>”.  This term was invented by Kent Beck and Martin Fowler when they worked with Fowler’s “Refactoring” book. A code smell is a set of “bad” coding practices, which are the drivers behind a corresponding set of refactorings.  <a href="http://sourcemaking.com/refactoring/bad-smells-in-code" target="_blank"><u>Here is a good list</u></a> of the smells, and their corresponding refactor patterns. See also <a href="http://www.codinghorror.com/blog/2006/05/code-smells.html" target="_blank"><u>this</u></a>. </li> </ul>